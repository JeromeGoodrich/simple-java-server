package HTTPServer;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.util.ArrayList;

    public class handleFile implements Handler {
        Response handle(Request request) {
            return new Response();
        }
    }

    public void buildResponseBody(String fileName) {
        if (new File(fileName).isDirectory()) {
            File dir = new File(fileName);
            String[] dirContents = dir.list();
            ArrayList files = new ArrayList<String>();
            for (String s : dirContents)
                files.add(s);
            setResponseBody(files);
        } else {
            try {
                FileReader fileReader = new FileReader(fileName);
                BufferedReader bufferedReader = new BufferedReader(fileReader);
                String line = null;
                ArrayList lines = new ArrayList<String>();
                while ((line = bufferedReader.readLine()) != null) {
                    lines.add(line);
                }
                setResponseBody(lines);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }




    Response handle(Request request) {
        String method = request.getMethod();
        String path = request.getPath();
        if (method.equals("GET")) {
            if (path.equals("/")) {
                return new Response(200, "Hello World", headers);
            } else {
                String fileName = path.replaceFirst("/", "");
                if (new File(fileName).isDirectory()) {
                    handleDirectory handler = new HandleDirectory();
                        handler.handle(request)

                            || new File(fileName).isFile()) {
                    return new Response(200, getResponseBody(fileName), getHeaders(fileName));
                } else {
                    return new Response(404, "Not Found");
                }
            }
        } else {
            return new Response(404, "", headers)
        }
    }
}
    public void parseContentType(String path) {
        String fileName = path.replaceFirst("/","");
        String[] splitFileName = fileName.split(".");
        String mimeType = splitFileName[1];
        String contentType = getmimeTypeMap().get(mimeType);
        setContentType(contentType);
    }
}

